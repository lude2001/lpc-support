# LPC Support 扩展

LPC Support 是一个为 LPC (LPMud Creation) 语言开发而设计的 VSCode 扩展，由武侠黎明团队开发，可能是目前国内首个多功能，通用性强的LPC语言的VSCode扩展。

## 注意事项

- 本扩展的语法规范仅适应作者团队的代码风格，请按需使用。
- 未使用变量的检查功能其中的一部分说明,目前不提示在定义变量后，在后续代码块中赋值但是没有被引用的变量。因为fluffos驱动的逻辑仅弹出[变量类型 变量名]或[变量类型 变量名=值]两种情况未使用的变量。为了兼容fluffos的逻辑，所以此处不提示。

## 功能特色

- **语法高亮**：LPC 语言语法高亮显示。
- **智能补全**：支持 LPC 内置函数（efun）、库函数及自定义函数的智能代码补全。
- **实时诊断**：自动检测语法错误、未使用变量及潜在问题，提升代码质量。
- **宏定义支持**：识别并处理宏定义，提供宏补全及跳转功能。
- **服务器管理**：简单添加、删除及管理 FluffOS 服务器配置，并支持一键编译文件至服务器。
- **代码格式化**：代码格式化，按作者团队代码风格格式化。
- **Efun 文档**：内置 efun 函数文档，支持实时查看和更新。
- **快速修复**：提供代码问题的快速修复建议。

## 安装与依赖

### 环境要求

- Visual Studio Code 版本 1.95.0 或更高
- Node.js 版本 16.x 或更高

### 安装步骤

1. 打开 VSCode 扩展市场，搜索 "LPC Support"。
2. 点击安装，并重启 VSCode 以激活扩展。

## 扩展配置

### 基础配置

在 VSCode 的设置中（文件 > 首选项 > 设置），可以配置以下选项：

1. **宏定义目录配置**
   - 配置项：`lpc.includePath`
   - 说明：设置宏定义文件所在的目录路径
   - 示例：`/path/to/include`

2. **模拟函数库配置**
   - 配置项：`lpc.simulatedEfunsPath`
   - 说明：设置模拟函数库目录的路径
   - 示例：`/path/to/simul_efun`

### 服务器配置

可以通过以下步骤配置 FluffOS 服务器：

1. 使用命令面板（Ctrl+Shift+P）输入 "LPC: 管理服务器"
2. 点击 "添加服务器" 并填写以下信息：
   - 服务器名称
   - 服务器URL（例如：http://127.0.0.1:8080）
   - 服务器描述（可选）

### 格式化配置

代码格式化遵循以下规则：
- 缩进大小：4个空格
- 最大行长度：80个字符
- 括号间距：保持空格
- 使用双引号
- 语句结尾使用分号
- 大括号前换行

## 使用指南

### 代码补全

扩展提供全面的代码补全功能：

1. **Efun 函数补全**
   - 自动显示函数签名
   - 实时显示函数文档
   - 参数提示

2. **宏定义补全**
   - 自动扫描宏定义文件
   - 显示宏定义值和注释
   - 支持跳转到定义

3. **自定义函数补全**
   - 项目内函数自动补全
   - 函数参数提示
   - 返回值类型提示

### 代码诊断

实时检测以下问题：

1. **语法错误**
   - 括号匹配
   - 语法规范检查
   - 类型检查

2. **变量检查**
   - 未使用变量提示
   - 未初始化变量检查
   - 重复定义检查

3. **函数检查**
   - 参数数量检查
   - 返回值类型检查
   - 未使用函数检查

### 服务器操作

1. **编译文件**
   - 快捷键：`Ctrl+F5`
   - 右键菜单：LPC > 编译文件
   - 支持文件夹批量编译

2. **服务器管理**
   - 添加/删除服务器
   - 修改服务器配置
   - 切换活动服务器

### Efun 文档

1. **查看文档**
   - 悬停显示函数文档
   - 支持中文文档
   - 实时更新

2. **文档更新**
   - 手动更新文档
   - 自动同步最新文档
   - 离线文档支持

## 快捷键

- `Ctrl+/`: 行注释
- `Shift+Alt+A`: 块注释
- `Ctrl+F5`: 编译当前文件
- `F12`: 跳转到定义
- `Alt+F12`: 查看定义

## 常见问题

1. **宏定义不生效**
   - 检查宏定义目录配置是否正确
   - 确认宏文件格式是否正确
   - 重新扫描宏定义（命令：LPC: 扫描宏定义）

2. **编译失败**
   - 检查服务器配置是否正确
   - 确认服务器是否在线
   - 查看错误日志获取详细信息

3. **代码补全不工作**
   - 确认文件扩展名是否正确（.c/.h/.lpc）
   - 检查语言服务是否正常启动
   - 尝试重新加载窗口

## 更多资源

- [LPC 语言文档](https://mud.wiki/LPC)
- [FluffOS 文档](https://www.fluffos.info)
- [项目 GitHub](https://github.com/yourusername/lpc-support)

## 版本更新

### 0.0.1

- 实现基本功能：语法高亮、代码补全、诊断及服务器管理
- 初步支持宏定义功能
- 添加 Efun 文档支持
- 实现代码快速修复功能

